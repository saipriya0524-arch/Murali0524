<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ToolStack</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0f0f0f;
  --card:#1b1b1b;
  --text:#ffffff;
  --muted:#aaa;
  --accent:#4dabf7;
}

/* single-source light mode (stable) */
.light{
  --bg:#f0fdf4;        /* soft green, NOT white */
  --card:#ffffff;
  --text:#0f172a;
  --muted:#475569;
  --accent:#2563eb;
}

body{
  margin:0;
  padding:90px 20px 60px;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* THEME */
#themeToggle{
  position:fixed;
  top:16px;
  right:16px;
  width:44px;
  height:44px;
  border-radius:50%;
  border:none;
  cursor:pointer;
  background:var(--card);
  color:var(--text);
}

/* HEADER */
header{text-align:center;margin-bottom:28px;}
header h1{margin:0;font-size:32px;}
header p{margin:6px 0 0;font-size:14px;color:var(--muted);}

/* CONTROLS */
.controls{
  display:flex;
  gap:10px;
  justify-content:center;
  flex-wrap:wrap;
}
input,select,button{
  padding:10px 12px;
  border-radius:8px;
  border:none;
}
button{background:#444;color:#fff;cursor:pointer;}
.light button{background:#2563eb;}

/* round refresh button ONLY */
#refreshBtn{
  width:40px;
  height:40px;
  border-radius:50%;
  padding:0;
  font-size:18px;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:18px;
}

/* CARD */
.card{
  background:var(--card);
  padding:14px;
  border-radius:14px;
  display:flex;
  flex-direction:column;
  gap:6px;
  min-height:140px;
  position:relative;
}

/* TITLE */
.title{
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:600;
  font-size:14.5px;
  color:var(--accent);
  text-decoration:none;
}
.favicon{width:20px;height:20px;border-radius:6px;}

/* CATEGORY */
.badge{
  align-self:flex-start;
  font-size:11px;
  padding:3px 10px;
  border-radius:999px;
  background:#2a2a2a;
  color:#cfe6ff;
}

/* DESCRIPTION */
.desc{
  font-size:12.5px;
  color:var(--muted);
  line-height:1.35;
}

/* STATUS */
.status{
  position:absolute;
  right:14px;
  bottom:12px;
  font-size:11.5px;
  display:flex;
  gap:6px;
}
.dot{width:9px;height:9px;border-radius:50%;}
.working{background:#22c55e;}
.broken{background:#ef4444;}
.redirect{background:#facc15;}
.unknown{background:#9ca3af;}

/* FAVORITE */
.star{
  position:absolute;
  top:12px;
  right:12px;
  font-size:18px;
  cursor:pointer;
  color:#777;
}
.star.active{color:#f59e0b;}

/* HELPERS */
.helper{
  font-size:12px;
  color:var(--muted);
  padding:8px 4px;
}

/* FOOTER */
footer{
  margin-top:60px;
  text-align:center;
  font-size:12px;
  color:var(--muted);
}

/* ABOUT MODAL */
#aboutModal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  align-items:center;
  justify-content:center;
}
#aboutBox{
  background:var(--card);
  padding:24px;
  max-width:520px;
  border-radius:14px;
}
#aboutBox button{
  margin-top:16px;
  background:var(--accent);
}
</style>
</head>

<body>

<button id="themeToggle">üåô</button>

<header>
  <h1>ToolStack</h1>
  <p>Explore curated tools with live status and smart categories.</p>
</header>

<div class="controls">
  <input id="search" placeholder="Search tools‚Ä¶">
  <select id="categoryFilter"><option value="all">All Categories</option></select>
  <button id="clearBtn">Clear</button>
  <button id="refreshBtn">‚Üª</button>
</div>

<div id="lastUpdated" style="text-align:center;margin:14px 0;"></div>

<div class="section">
  <h2>‚≠ê Favorites</h2>
  <div id="favHelper" class="helper"></div>
  <div id="favGrid" class="grid"></div>
</div>

<div class="section">
  <h2>üïí Recent</h2>
  <div id="recentHelper" class="helper"></div>
  <div id="recentGrid" class="grid"></div>
</div>

<div class="section">
  <h2>üì¶ All Tools</h2>
  <div id="grid" class="grid"></div>
</div>

<footer>
  <div style="margin-top:60px;text-align:center;font-size:12px;color:var(--muted);line-height:1.6;">
    <a href="#" onclick="openAbout()">About</a> ¬∑
    <a href="#" onclick="openAbout()">Credits</a> ¬∑
    <a href="#" onclick="openAbout()">Disclaimer</a>
    <br>
    Built &amp; Developed by <b>Murali</b> ¬© 2025‚Äì26
  </div>
</footer>


<div id="aboutModal">
  <div id="aboutBox">
    <h3>About ToolStack</h3>
    <p>ToolStack is a curated, read-only discovery platform that tracks live availability of tools.</p>
    <p><b>Built & Developed by Murali</b></p>
    <p>Data sourced from public links. No ownership implied.</p>
    <button onclick="closeAbout()">Close</button>
  </div>
</div>

<script>
/* ================= CORE PROD LOGIC ================= */

const SHEET_URL =
"https://docs.google.com/spreadsheets/d/1_lz8NoO69rbSpE0yyTgJaxy0erMFmcvK1L88P40JJlY/gviz/tq?gid=1452664636&tqx=out:json&tq=select * limit 1000";

let data=[], lastFetchTime=null;
let favorites=JSON.parse(localStorage.getItem("favorites")||"[]");
let recent=JSON.parse(localStorage.getItem("recent")||"[]");

/* ABOUT */
function openAbout(){aboutModal.style.display="flex";}
function closeAbout(){aboutModal.style.display="none";}

/* THEME */
if(localStorage.getItem("theme")==="light"){
 document.body.classList.add("light");
 themeToggle.textContent="‚òÄÔ∏è";
}
themeToggle.onclick=()=>{
 document.body.classList.toggle("light");
 const l=document.body.classList.contains("light");
 localStorage.setItem("theme",l?"light":"dark");
 themeToggle.textContent=l?"‚òÄÔ∏è":"üåô";
};

/* HELPERS */
function updateHelpers(){
 favHelper.textContent=favorites.length? "" : "‚≠ê Star tools to see them here";
 recentHelper.textContent=recent.length? "" : "üïí Tools you open appear here";
}

/* UPDATED TIME */
function updateTime(){
 if(!lastFetchTime) return;
 const mins=Math.floor((Date.now()-lastFetchTime)/60000);
 lastUpdated.textContent=mins<1?"Updated just now":`Updated ${mins} min ago`;
}
setInterval(updateTime,60000);

/* LOAD DATA */
async function loadData(force=false){
 try{
  const res=await fetch(SHEET_URL);
  const txt=await res.text();
  const json=JSON.parse(txt.substring(47).slice(0,-2));
  const cols=json.table.cols.map(c=>c.label.toLowerCase());
  const i={url:cols.indexOf("url"),desc:cols.indexOf("description"),label:cols.indexOf("status_label")};
  data=json.table.rows.map(r=>{
    return{
      url:r.c[i.url]?.v||"",
      desc:r.c[i.desc]?.v||"",
      label:r.c[i.label]?.v||"Unknown"
    };
  }).filter(d=>d.url);
  lastFetchTime=Date.now();
  render();
 }catch{
  grid.innerHTML="<div class='helper'>‚ö† Connect to internet to load tools</div>";
 }
}

/* RENDER */
function render(){
 grid.innerHTML=favGrid.innerHTML=recentGrid.innerHTML="";
 updateHelpers();
 data.forEach(t=>grid.appendChild(createCard(t)));
 favorites.map(f=>data.find(d=>d.url===f)).filter(Boolean)
   .forEach(t=>favGrid.appendChild(createCard(t)));
 recent.map(r=>data.find(d=>d.url===r)).filter(Boolean)
   .forEach(t=>recentGrid.appendChild(createCard(t)));
 updateTime();
}

/* CARD */
function createCard(t){
 const card=document.createElement("div");
 card.className="card";
 const fav=favorites.includes(t.url);
 card.innerHTML=`
  <span class="star ${fav?"active":""}">‚òÖ</span>
  <a class="title" href="${t.url}" target="_blank">${t.url}</a>
  <div class="desc">${t.desc}</div>
  <div class="status"><span class="dot unknown"></span>${t.label}</div>
 `;
 card.querySelector(".star").onclick=e=>{
  e.stopPropagation();
  fav?favorites=favorites.filter(f=>f!==t.url):favorites.push(t.url);
  localStorage.setItem("favorites",JSON.stringify(favorites));
  render();
 };
 card.querySelector(".title").onclick=()=>{
  recent=recent.filter(r=>r!==t.url);
  recent.unshift(t.url);
  recent=recent.slice(0,5);
  localStorage.setItem("recent",JSON.stringify(recent));
 };
 return card;
}

/* CONTROLS */
clearBtn.onclick=()=>{search.value="";render();}
refreshBtn.onclick=()=>loadData(true);

loadData();
</script>

</body>
</html>
