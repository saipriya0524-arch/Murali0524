<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Useful Tools Hub</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#0f0f0f;
  --card:#1b1b1b;
  --text:#ffffff;
  --muted:#aaa;
  --accent:#4dabf7;
}

.light {
  --bg:#f2f4f7;
  --card:#ffffff;
  --text:#111;
  --muted:#555;
  --accent:#2563eb;
}

body {
  margin:0;
  padding:70px 20px 20px;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

#themeToggle {
  position:fixed;
  top:14px;
  right:14px;
  width:48px;
  height:48px;
  border-radius:50%;
  border:none;
  cursor:pointer;
  font-size:22px;
  background:var(--card);
  color:var(--text);
}

h1 { text-align:center; }

.controls {
  display:flex;
  gap:10px;
  justify-content:center;
  margin-bottom:20px;
  flex-wrap:wrap;
}

input, select, button {
  padding:10px;
  border-radius:8px;
  border:none;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:16px;
}

.card {
  background:var(--card);
  padding:16px;
  border-radius:14px;
  position:relative;
  transition:.25s;
}

.card:hover {
  transform:translateY(-6px);
  box-shadow:0 12px 30px rgba(0,0,0,.45);
}

.title { color:var(--accent); font-weight:bold; text-decoration:none; }
.desc { font-size:14px; color:var(--muted); }

.star {
  position:absolute;
  top:10px;
  right:10px;
  cursor:pointer;
  font-size:20px;
}

.star.active { color:gold; }

.status {
  position:absolute;
  bottom:12px;
  right:12px;
  display:flex;
  align-items:center;
  gap:6px;
  font-size:11px;
}

.status-dot {
  width:8px;
  height:8px;
  border-radius:50%;
}

.status.working .status-dot { background:#22c55e; }
.status.redirect .status-dot { background:#facc15; }
.status.blocked .status-dot { background:#ef4444; }
.status.broken .status-dot { background:#f59e0b; }
.status.unknown .status-dot { background:#6b7280; }

footer {
  margin-top:40px;
  text-align:center;
  opacity:.7;
}
</style>
</head>

<body>

<button id="themeToggle">üåô</button>

<h1>üß† Useful Tools Hub</h1>

<div class="controls">
  <input id="search" placeholder="Search tools...">
  <select id="categoryFilter"><option value="all">All</option></select>
  <button id="clearFilter">Clear</button>
</div>

<h3>üïí Recent</h3>
<div id="recentGrid" class="grid"></div>

<h3>‚≠ê Favorites</h3>
<div id="favGrid" class="grid"></div>

<h3>All Tools</h3>
<div id="grid" class="grid"></div>

<footer>Credits to <b>Murali K</b></footer>

<script>
const tools = [
  {url:"https://openai.com",desc:"AI Platform",cat:"AI"},
  {url:"https://www.google.com",desc:"Search Engine",cat:"Utility"},
  {url:"https://github.com",desc:"Code Hosting",cat:"Development"}
];

let favs = JSON.parse(localStorage.getItem("favs") || "[]");
let recents = JSON.parse(localStorage.getItem("recents") || "[]");
let statusMap = {};

const grid = document.getElementById("grid");
const favGrid = document.getElementById("favGrid");
const recentGrid = document.getElementById("recentGrid");

[...new Set(tools.map(t => t.cat))].forEach(c => {
  const o = document.createElement("option");
  o.value = c;
  o.textContent = c;
  categoryFilter.appendChild(o);
});

async function loadStatusData() {
  try {
    const url = "https://docs.google.com/spreadsheets/d/1_lz8NoO69rbSpE0yyTgJaxy0erMFmcvK1L88P40JJlY/gviz/tq?gid=1452664636&tqx=out:json";
    const res = await fetch(url);
    const text = await res.text();
    const json = JSON.parse(text.substring(47).slice(0, -2));

    const cols = json.table.cols.map(c => c.label.toLowerCase());
    const urlIndex = cols.indexOf("url");
    const statusIndex = cols.indexOf("status");

    json.table.rows.forEach(r => {
      const link = r.c[urlIndex]?.v;
      const status = r.c[statusIndex]?.v;
      if (link) statusMap[link] = String(status).toLowerCase();
    });

  } catch (e) {
    console.error("Sheet load failed", e);
  }
}

function makeCard(t) {
  const card = document.createElement("div");
  card.className = "card";

  const star = document.createElement("div");
  star.className = "star" + (favs.includes(t.url) ? " active" : "");
  star.textContent = "‚òÖ";

  star.onclick = e => {
    e.stopPropagation();
    favs.includes(t.url)
      ? favs = favs.filter(x => x !== t.url)
      : favs.push(t.url);
    localStorage.setItem("favs", JSON.stringify(favs));
    render();
  };

  card.innerHTML = `
    <a class="title" href="${t.url}" target="_blank">${t.url.replace("https://","")}</a>
    <div class="desc">${t.desc}</div>
  `;

  let status = statusMap[t.url] || "unknown";
  const s = document.createElement("div");
  s.className = "status " + status;
  s.innerHTML = `<span class="status-dot"></span>${status}`;
  card.appendChild(s);
  card.appendChild(star);

  card.onclick = () => {
    recents = [t.url, ...recents.filter(x => x !== t.url)].slice(0,5);
    localStorage.setItem("recents", JSON.stringify(recents));
    render();
  };

  return card;
}

function render() {
  grid.innerHTML = favGrid.innerHTML = recentGrid.innerHTML = "";
  const q = search.value.toLowerCase();
  const c = categoryFilter.value;

  tools.forEach(t => {
    if ((q && !t.url.includes(q) && !t.desc.toLowerCase().includes(q)) ||
        (c !== "all" && t.cat !== c)) return;
    grid.appendChild(makeCard(t));
  });

  favs.forEach(f => {
    const t = tools.find(x => x.url === f);
    if (t) favGrid.appendChild(makeCard(t));
  });

  recents.forEach(r => {
    const t = tools.find(x => x.url === r);
    if (t) recentGrid.appendChild(makeCard(t));
  });
}

document.getElementById("themeToggle").onclick = () => {
  document.body.classList.toggle("light");
};

document.getElementById("clearFilter").onclick = () => {
  search.value = "";
  categoryFilter.value = "all";
  render();
};

search.oninput = render;
categoryFilter.onchange = render;

loadStatusData().then(render);
</script>

</body>
</html>

